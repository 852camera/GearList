<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gear Availability Generator</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Inter:wght@400;600;800&family=Noto+Sans+TC:wght@500;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* CORE PALETTE */
            --brand-main: #0f2f5d; 
            --brand-mid: #1b4b8f; /* Lighter navy for gradient bridge */
            --brand-deep: #020b16; /* Near black for bottom */
            --neon-cyan: #00f2ff;
            --text-white: #ffffff;
            --bg-page: #eef2f5;
        }

        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: var(--bg-page);
            margin: 0;
            padding: 20px 20px 120px 20px;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { 
            font-family: 'Oswald', sans-serif;
            font-size: 1.5rem; 
            text-align: center; 
            margin-bottom: 20px; 
            color: var(--brand-main); 
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* --- MODE SWITCHER --- */
        .mode-container {
            background: #fff;
            padding: 6px;
            border-radius: 50px;
            box-shadow: 0 4px 20px rgba(15, 47, 93, 0.1);
            margin-bottom: 25px;
            display: flex;
            position: relative;
            width: 100%;
            max-width: 320px;
            border: 1px solid #dae1e7;
        }

        .mode-btn {
            flex: 1;
            border: none;
            background: transparent;
            padding: 12px 0;
            border-radius: 40px;
            font-size: 0.9rem;
            font-weight: 700;
            color: #8898aa;
            cursor: pointer;
            z-index: 2;
            transition: color 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .mode-btn.active { color: white; }

        .slider {
            position: absolute;
            top: 6px;
            left: 6px;
            height: calc(100% - 12px);
            width: calc(50% - 6px);
            background: var(--brand-main);
            border-radius: 40px;
            transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            z-index: 1;
            box-shadow: 0 2px 10px rgba(15, 47, 93, 0.4);
        }

        /* --- CONTROLS --- */
        .controls {
            width: 100%;
            max-width: 500px;
            margin-bottom: 30px;
        }

        .category {
            background: white;
            border-radius: 16px;
            padding: 18px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.03);
            border: 1px solid rgba(255,255,255,0.5);
        }

        .cat-title {
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--brand-main);
            text-transform: uppercase;
            font-size: 1rem;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .cat-title::after {
            content: '';
            flex: 1;
            height: 2px;
            background: #f0f2f5;
        }

        .item-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .gear-btn {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            color: #6c757d;
            padding: 10px 16px;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 1, 0.5, 1);
            user-select: none;
            flex-grow: 1;
            text-align: center;
        }

        .gear-btn:active { transform: scale(0.96); }

        .gear-btn.active {
            background: var(--brand-main);
            color: var(--neon-cyan);
            border-color: var(--brand-main);
            box-shadow: 0 4px 12px rgba(15, 47, 93, 0.3);
            transform: translateY(-1px);
        }

        /* --- PREVIEW AREA --- */
        .preview-wrapper {
            width: 100%;
            display: flex;
            justify-content: center;
            margin-bottom: 50px;
            perspective: 1000px;
        }

        .preview-container {
            transform-origin: top center;
            box-shadow: 0 30px 80px rgba(15, 47, 93, 0.4);
            border-radius: 8px;
        }

        /* --- THE CANVAS DESIGN (1080x1920) --- */
        #story-canvas {
            width: 1080px;
            height: 1920px;
            position: relative;
            /* UPDATED GRADIENT:
               3-Stop Gradient (Highlight -> Brand -> Deep)
               This smooths out transitions better than 2-stop.
            */
            background: radial-gradient(circle at 50% -10%, var(--brand-mid) 0%, var(--brand-main) 45%, var(--brand-deep) 100%);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
            color: white;
            padding: 80px;
        }

        /* Clean Tech Grid (No Noise) */
        .bg-grid {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 60px 60px;
            z-index: 1;
            pointer-events: none;
        }

        /* Top Accent Bar */
        .top-accent {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 15px;
            background: linear-gradient(90deg, var(--neon-cyan), var(--brand-main));
            z-index: 10;
        }

        /* Header Section */
        .story-header {
            position: relative;
            z-index: 10;
            margin-bottom: 40px; /* Reduced slightly to save space */
            border-left: 10px solid var(--neon-cyan);
            padding-left: 40px;
            flex-shrink: 0; 
        }

        .brand-name {
            font-family: 'Oswald', sans-serif;
            font-size: 40px;
            letter-spacing: 4px;
            opacity: 0.8;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .main-title {
            font-family: 'Oswald', sans-serif;
            font-size: 110px;
            line-height: 0.9;
            font-weight: 700;
            text-transform: uppercase;
            text-shadow: 0 0 40px rgba(0, 242, 255, 0.3);
            margin: 0;
        }
        
        .main-title span { color: var(--neon-cyan); }

        .date-badge {
            margin-top: 30px;
            display: inline-block;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 10px 30px;
            border-radius: 12px;
            font-family: 'Oswald', sans-serif;
            font-size: 45px;
            color: #fff;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        /* List Section */
        .story-list {
            position: relative;
            z-index: 10;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-content: flex-start;
            transform-origin: top left; /* Important for scaling */
            transition: transform 0.2s;
        }

        .story-list.layout-grid {
            display: block;
            column-count: 2;
            column-gap: 50px;
        }

        .list-group-box {
            break-inside: avoid;
            margin-bottom: 35px;
            background: rgba(15, 47, 93, 0.4);
            border: 1px solid rgba(76, 201, 240, 0.3);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .list-group-label {
            font-family: 'Oswald', sans-serif;
            font-size: 32px;
            color: var(--neon-cyan);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 0 15px rgba(0, 242, 255, 0.4);
        }

        .list-item {
            font-family: 'Noto Sans TC', sans-serif;
            font-size: 38px;
            font-weight: 500;
            margin-bottom: 12px;
            color: #fff;
            display: flex;
            align-items: center;
        }

        .list-item i {
            color: var(--neon-cyan);
            font-size: 24px;
            margin-right: 15px;
            opacity: 0.8;
        }

        /* Dense Mode Adjustments */
        .story-list.layout-dense .list-item { font-size: 30px; margin-bottom: 8px; }
        .story-list.layout-dense .list-group-label { font-size: 26px; }
        .story-list.layout-dense .list-group-box { padding: 20px; margin-bottom: 25px; }

        /* Footer */
        .story-footer {
            position: relative;
            z-index: 10;
            margin-top: auto;
            display: flex;
            justify-content: center;
            align-items: center;
            padding-top: 20px;
            padding-bottom: 40px; /* Ensure space at bottom */
            flex-shrink: 0; 
        }

        .sticker-cta {
            background: var(--neon-cyan);
            color: var(--brand-main);
            font-family: 'Oswald', sans-serif;
            font-size: 50px;
            font-weight: 700;
            padding: 20px 60px;
            transform: rotate(-2deg);
            box-shadow: 0 15px 40px rgba(0, 242, 255, 0.3);
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 20px;
            clip-path: polygon(5% 0%, 100% 0%, 95% 100%, 0% 100%);
        }

        /* --- ACTION BUTTONS --- */
        .actions {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            display: flex;
            gap: 12px;
            width: 90%;
            max-width: 420px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 10px;
            border-radius: 60px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.5);
        }

        .action-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            text-transform: uppercase;
            font-family: 'Oswald', sans-serif;
            letter-spacing: 1px;
            transition: transform 0.1s;
        }
        
        .action-btn:active { transform: scale(0.95); }

        .btn-reset { 
            background: transparent; 
            color: var(--brand-main); 
        }
        
        .btn-download { 
            background: var(--brand-main); 
            color: var(--neon-cyan); 
            box-shadow: 0 5px 15px rgba(15, 47, 93, 0.3);
        }

    </style>
</head>
<body>

    <h1>RENTAL GEAR GENERATOR</h1>

    <div class="mode-container">
        <div class="slider" id="mode-slider"></div>
        <button class="mode-btn active" id="mode-tomorrow" onclick="setMode('tomorrow')">Tomorrow</button>
        <button class="mode-btn" id="mode-weekend" onclick="setMode('weekend')">Weekend</button>
    </div>

    <div class="controls" id="controls"></div>

    <div class="preview-wrapper">
        <div class="preview-container" id="preview-container">
            <div id="story-canvas">
                <div class="top-accent"></div>
                <div class="bg-grid"></div>
                
                <div class="story-header">
                    <div class="brand-name">852CAMERA</div>
                    <h2 class="main-title" id="header-title">RENTAL<br><span>LIST</span></h2>
                    <div class="date-badge">
                        <i class="far fa-calendar-alt"></i> <span id="display-date">--/--</span>
                    </div>
                </div>
                
                <div class="story-list" id="story-list">
                    <div style="flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; opacity: 0.3; color: white;">
                        <i class="fas fa-camera" style="font-size: 100px; margin-bottom: 20px;"></i>
                        <div style="font-size: 40px; font-family: 'Oswald';">SELECT GEAR</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="actions">
        <button class="action-btn btn-reset" onclick="resetAll()">Clear</button>
        <button class="action-btn btn-download" onclick="downloadImage()">
            <i class="fas fa-download"></i> Save Image
        </button>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        const gearData = [
            { group: "電話", items: ["Samsung S24 Ultra", "Samsung S25 Ultra", "Vivo X200 Ultra 攝影套裝", "Vivo X300 Pro 攝影套裝"] },
            { group: "Canon 相機機身", items: ["Canon R5", "Canon R5 Mark II", "Canon R6 Mark II", "Canon R6 Mark III"] },
            { group: "Canon 鏡頭", items: ["EF 70-200mm f/2.8L II", "RF 70-200mm f/2.8L", "RF 100-500mm L", "RF 100-400mm", "RF 50mm f/1.8"] },
            { group: "Sony 相機機身", items: ["Sony A7R V", "Sony A7C II"] },
            { group: "Sony 鏡頭", items: ["FE 50-150mm f/2 GM", "FE 70-200 GM II", "FE 100-400 GM", "FE 200-600 G", "1.4x Teleconverter"] },
            { group: "一體式旅行相機", items: ["Fujifilm X100VI", "Leica Q2"] }
        ];

        const selectedItems = new Set();
        let currentMode = 'tomorrow';

        function init() {
            const container = document.getElementById('controls');
            
            gearData.forEach(cat => {
                const catDiv = document.createElement('div');
                catDiv.className = 'category';
                
                const title = document.createElement('div');
                title.className = 'cat-title';
                title.innerHTML = `<i class="fas fa-caret-right" style="color:var(--brand-main)"></i> ${cat.group}`;
                
                const grid = document.createElement('div');
                grid.className = 'item-grid';

                cat.items.forEach(item => {
                    const btn = document.createElement('div');
                    btn.className = 'gear-btn';
                    btn.innerText = item;
                    btn.onclick = () => toggleItem(btn, item, cat.group);
                    grid.appendChild(btn);
                });

                catDiv.appendChild(title);
                catDiv.appendChild(grid);
                container.appendChild(catDiv);
            });

            setMode('tomorrow');
            resizePreview();
            window.addEventListener('resize', resizePreview);
        }

        function setMode(mode) {
            currentMode = mode;
            const slider = document.getElementById('mode-slider');
            const tmrBtn = document.getElementById('mode-tomorrow');
            const wkndBtn = document.getElementById('mode-weekend');

            if (mode === 'tomorrow') {
                slider.style.transform = 'translateX(0%)';
                tmrBtn.classList.add('active');
                wkndBtn.classList.remove('active');
            } else {
                slider.style.transform = 'translateX(100%)';
                tmrBtn.classList.remove('active');
                wkndBtn.classList.add('active');
            }
            updateDateAndTitle();
        }

        function updateDateAndTitle() {
            const dateDisplay = document.getElementById('display-date');
            const headerTitle = document.getElementById('header-title');
            const today = new Date();

            if (currentMode === 'tomorrow') {
                const startDate = new Date(today); startDate.setDate(today.getDate() + 1);
                const endDate = new Date(today); endDate.setDate(today.getDate() + 2);
                const sStr = `${String(startDate.getDate()).padStart(2,'0')}/${String(startDate.getMonth()+1).padStart(2,'0')}`;
                const eStr = `${String(endDate.getDate()).padStart(2,'0')}/${String(endDate.getMonth()+1).padStart(2,'0')}`;
                dateDisplay.innerText = `${sStr} - ${eStr}`;
                headerTitle.innerHTML = `明天<br><span>可租用器材</span>`;
            } else {
                const dayOfWeek = today.getDay(); 
                const daysUntilSat = (6 - dayOfWeek + 7) % 7; 
                const satDate = new Date(today); satDate.setDate(today.getDate() + daysUntilSat);
                const sunDate = new Date(satDate); sunDate.setDate(satDate.getDate() + 1);
                const satStr = `${String(satDate.getDate()).padStart(2,'0')}/${String(satDate.getMonth()+1).padStart(2,'0')}`;
                const sunStr = `${String(sunDate.getDate()).padStart(2,'0')}/${String(sunDate.getMonth()+1).padStart(2,'0')}`;
                dateDisplay.innerText = `${satStr} - ${sunStr}`;
                headerTitle.innerHTML = `本週末<br><span>可租用器材</span>`;
            }
        }

        function toggleItem(btn, itemName, groupName) {
            btn.classList.toggle('active');
            const key = JSON.stringify({ group: groupName, item: itemName });
            if (selectedItems.has(key)) selectedItems.delete(key);
            else selectedItems.add(key);
            renderPreview();
        }

        function renderPreview() {
            const listContainer = document.getElementById('story-list');
            listContainer.innerHTML = '';
            
            const totalItems = selectedItems.size;
            listContainer.classList.remove('layout-grid', 'layout-dense');

            if (totalItems > 18) {
                listContainer.classList.add('layout-grid', 'layout-dense');
            } else if (totalItems > 8) {
                listContainer.classList.add('layout-grid');
            }

            if (totalItems === 0) {
                listContainer.innerHTML = `
                    <div style="flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; opacity: 0.3; color: white;">
                        <i class="fas fa-camera" style="font-size: 100px; margin-bottom: 20px;"></i>
                        <div style="font-size: 40px; font-family: 'Oswald';">SELECT GEAR</div>
                    </div>`;
                return;
            }

            const groupedSelection = {};
            Array.from(selectedItems).map(k => JSON.parse(k)).forEach(obj => {
                if (!groupedSelection[obj.group]) groupedSelection[obj.group] = [];
                groupedSelection[obj.group].push(obj.item);
            });

            // --- NEW: SORT ITEMS ALPHABETICALLY ---
            // This ensures that regardless of click order, items appear A-Z
            Object.keys(groupedSelection).forEach(groupName => {
                groupedSelection[groupName].sort((a, b) => a.localeCompare(b, 'zh-HK', { numeric: true }));
            });
            // --------------------------------------

            gearData.forEach(cat => {
                if (groupedSelection[cat.group]) {
                    const groupBox = document.createElement('div');
                    groupBox.className = 'list-group-box';
                    const header = document.createElement('div');
                    header.className = 'list-group-label';
                    header.innerText = cat.group;
                    groupBox.appendChild(header);
                    
                    groupedSelection[cat.group].forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'list-item';
                        div.innerHTML = `<i class="fas fa-square-full" style="font-size: 10px; transform: rotate(45deg);"></i> ${item}`;
                        groupBox.appendChild(div);
                    });
                    listContainer.appendChild(groupBox);
                }
            });
        }

        function resetAll() {
            selectedItems.clear();
            document.querySelectorAll('.gear-btn').forEach(b => b.classList.remove('active'));
            renderPreview();
        }

        function resizePreview() {
            const container = document.getElementById('preview-container');
            const canvas = document.getElementById('story-canvas');
            const screenWidth = window.innerWidth;
            let scale = (screenWidth - 40) / 1080;
            if (scale > 0.45) scale = 0.45;
            container.style.width = `${1080 * scale}px`;
            container.style.height = `${1920 * scale}px`;
            canvas.style.transform = `scale(${scale})`;
            canvas.style.transformOrigin = 'top left';
        }

        function downloadImage() {
            const element = document.getElementById("story-canvas");
            const currentTransform = element.style.transform;
            
            // Temporarily reset scale for capture
            element.style.transform = "scale(1)";
            
            html2canvas(element, {
                scale: 2, 
                useCORS: true,
                backgroundColor: null 
            }).then(canvas => {
                element.style.transform = currentTransform; // Restore preview
                const link = document.createElement('a');
                link.download = `852Camera_List.png`;
                link.href = canvas.toDataURL("image/png");
                link.click();
            });
        }

        init();
    </script>
</body>
</html>
